# Data Dictionary — Fleet Maintenance & Transport Operations System
**Author:** ASDODJI Le Sage (27232)  
**Date:** November 2025

> Conventions: `PK` = Primary Key, `FK` = Foreign Key. `NN` = NOT NULL. Use `IDENTITY` or sequences for `NUMBER` PKs in Oracle.

---

## 1. VEHICLES
**Description:** Stores fleet vehicle master data.

- `vehicle_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `plate_number` VARCHAR2(20) — NOT NULL, **UNIQUE**  
- `brand` VARCHAR2(50)  
- `model` VARCHAR2(50)  
- `capacity_tons` NUMBER(6,2) CHECK (capacity_tons >= 0)  
- `status` VARCHAR2(20) DEFAULT 'ACTIVE' CHECK (status IN ('ACTIVE','MAINTENANCE','OUT_OF_SERVICE'))

**Business rules:** `plate_number` unique; use `status` for soft-deletes / availability checks.

---

## 2. DRIVERS
**Description:** Professional drivers.

- `driver_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `full_name` VARCHAR2(100) — NOT NULL  
- `license_number` VARCHAR2(50) — UNIQUE  
- `experience_yrs` NUMBER(3) DEFAULT 0 CHECK (experience_yrs >= 0)  
- `status` VARCHAR2(20) DEFAULT 'ACTIVE' CHECK (status IN ('ACTIVE','SUSPENDED'))

---

## 3. ROUTES
**Description:** Predefined trips/origins-destinations.

- `route_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `origin_city` VARCHAR2(100) — NOT NULL  
- `destination_city` VARCHAR2(100) — NOT NULL  
- `distance_km` NUMBER(8,2) CHECK (distance_km >= 0)  
- `base_risk` VARCHAR2(10) DEFAULT 'LOW' CHECK (base_risk IN ('LOW','MEDIUM','HIGH'))

---

## 4. TRIPS
**Description:** One execution of a route by a vehicle & driver.

- `trip_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `vehicle_id` NUMBER — **FK → VEHICLES(vehicle_id)**, NOT NULL  
- `driver_id` NUMBER — **FK → DRIVERS(driver_id)**, NOT NULL  
- `route_id` NUMBER — **FK → ROUTES(route_id)**, NOT NULL  
- `departure_time` TIMESTAMP  
- `arrival_time` TIMESTAMP  
- `planned_arrival` TIMESTAMP  
- `trip_status` VARCHAR2(20) DEFAULT 'PLANNED' CHECK (trip_status IN ('PLANNED','IN_PROGRESS','COMPLETED','CANCELLED'))  
- `delay_minutes` NUMBER DEFAULT 0 CHECK (delay_minutes >= 0)

**Business rule:** before setting `trip_status` = 'IN_PROGRESS', validate `VEHICLES.status='ACTIVE'` and `DRIVERS.status='ACTIVE'` via PL/SQL.

---

## 5. INCIDENTS
**Description:** Problems reported during trips.

- `incident_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `trip_id` NUMBER — **FK → TRIPS(trip_id)**, NOT NULL  
- `incident_time` TIMESTAMP DEFAULT SYSTIMESTAMP  
- `incident_type` VARCHAR2(30) CHECK (incident_type IN ('BREAKDOWN','ACCIDENT','OVERSPEED','ROUTE_DEVIATION','OTHER'))  
- `severity` VARCHAR2(20) CHECK (severity IN ('MINOR','MAJOR','CRITICAL'))  
- `description` VARCHAR2(4000)

**Index suggestions:** `INCIDENTS(trip_id)`, `incident_time`, `severity`.

---

## 6. PARTS
**Description:** Consumable and replaceable parts inventory.

- `part_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `part_name` VARCHAR2(150) — NOT NULL  
- `unit_price` NUMBER(12,2) DEFAULT 0 CHECK (unit_price >= 0)  
- `stock_qty` NUMBER DEFAULT 0 CHECK (stock_qty >= 0)

**Notes:** stock adjustments performed in transactional procedure when maintenance recorded.

---

## 7. MAINTENANCE_RECORDS
**Description:** Work orders / maintenance events for vehicles.

- `maintenance_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `vehicle_id` NUMBER — **FK → VEHICLES(vehicle_id)**, NOT NULL  
- `maintenance_date` DATE DEFAULT SYSDATE NOT NULL  
- `maintenance_type` VARCHAR2(20) CHECK (maintenance_type IN ('SCHEDULED','CORRECTIVE','EMERGENCY'))  
- `cost_amount` NUMBER(12,2) DEFAULT 0 CHECK (cost_amount >= 0)  
- `technician_id` NUMBER NULL — FK → USERS(user_id) (or DRIVERS(driver_id) if you prefer)  
- `next_due_date` DATE NULL  
- `notes` VARCHAR2(4000) NULL

**Business rule:** Insert maintenance record, maintenance_parts, and decrement `PARTS.stock_qty` inside a transactional procedure.

---

## 8. MAINTENANCE_PARTS (junction)
**Description:** Parts used per maintenance event (many-to-many resolution).

- `maintenance_id` NUMBER — **PK part**, FK → MAINTENANCE_RECORDS(maintenance_id), NOT NULL  
- `part_id` NUMBER — **PK part**, FK → PARTS(part_id), NOT NULL  
- `quantity` NUMBER DEFAULT 1 CHECK (quantity > 0)

**Composite PK:** (`maintenance_id`, `part_id`) — prevents duplicate part entries for same maintenance.

---

## 9. USERS
**Description:** Application users for approvals, audit, and system actions.

- `user_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `username` VARCHAR2(50) — NOT NULL, UNIQUE  
- `full_name` VARCHAR2(150) — NOT NULL  
- `role` VARCHAR2(30) CHECK (role IN ('ADMIN','FLEET_MANAGER','DISPATCHER','TECHNICIAN','PARTS_CLERK'))  
- `email` VARCHAR2(100)

---

## 10. ALERTS
**Description:** System-generated alerts (polymorphic target).

- `alert_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `entity_type` VARCHAR2(20) — NOT NULL CHECK (entity_type IN ('VEHICLE','DRIVER','ROUTE','TRIP'))  
- `entity_id` NUMBER — NOT NULL (polymorphic target id)  
- `alert_time` TIMESTAMP DEFAULT SYSTIMESTAMP  
- `alert_type` VARCHAR2(50)  
- `severity` VARCHAR2(20)  
- `risk_score` NUMBER(5,2)  
- `message` VARCHAR2(2000)  
- `status` VARCHAR2(20) DEFAULT 'OPEN' CHECK (status IN ('OPEN','IN_PROGRESS','RESOLVED'))

**Note:** `entity_type` + `entity_id` is polymorphic; application logic enforces mapping.

---

## 11. RISK_SCORES
**Description:** Current computed risk per entity (vehicle/driver/route).

- `entity_type` VARCHAR2(20) — **PK part**, CHECK (entity_type IN ('VEHICLE','DRIVER','ROUTE'))  
- `entity_id` NUMBER — **PK part**  
- `risk_score` NUMBER(5,2) DEFAULT 0 CHECK (risk_score BETWEEN 0 AND 100)  
- `last_calculated` TIMESTAMP

**Primary Key:** composite (`entity_type`, `entity_id`). No FK due to polymorphism.

---

## 12. AUDIT_LOG
**Description:** Immutable action trail for critical operations.

- `log_id` NUMBER — **PK**, NOT NULL, GENERATED BY DEFAULT ON NULL AS IDENTITY  
- `user_id` NUMBER — FK → USERS(user_id), NULLABLE (system actions may be NULL)  
- `action_time` TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL  
- `action_type` VARCHAR2(50) NOT NULL  
- `details` VARCHAR2(4000) NULL

**Business rule:** append-only; triggers write entries for critical table changes.

---

## Index & Performance Suggestions
- Index foreign keys and frequently queried date fields:  
  - `TRIPS(vehicle_id)`, `TRIPS(driver_id)`, `MAINTENANCE_RECORDS(maintenance_date)`, `MAINTENANCE_PARTS(part_id)`, `INCIDENTS(trip_id)`
- Consider materialized views for heavy BI queries (monthly maintenance totals, parts usage).

---

## Assumptions (concise)
1. `technician_id` in `MAINTENANCE_RECORDS` references `USERS.user_id`. (Document choice.)  
2. For historical pricing, optionally add `unit_price_at_maintenance` to `MAINTENANCE_PARTS`.  
3. Prefer soft deletes (`status` flags) to physical deletes on key tables.  
4. Use `TIMESTAMP` or `TIMESTAMP WITH TIME ZONE` if multi-region.  
5. All stock updates and maintenance inserts occur within stored procedures/transactions to preserve integrity.

---

## Example row set (to help testers)
```sql
-- vehicles
INSERT INTO VEHICLES (vehicle_id, plate_number, brand, model, capacity_tons, status)
VALUES (1, 'RAD-123Z', 'Toyota', 'Hilux', 1.5, 'ACTIVE');

-- parts
INSERT INTO PARTS (part_id, part_name, unit_price, stock_qty)
VALUES (200, 'Brake Pads', 120.00, 25);

-- maintenance_records
INSERT INTO MAINTENANCE_RECORDS (maintenance_id, vehicle_id, maintenance_date, maintenance_type, cost_amount, technician_id, next_due_date, notes)
VALUES (3000, 1, DATE '2025-11-10', 'CORRECTIVE', 1007.50, 21, DATE '2026-05-10', 'Replaced pads & filter');

-- maintenance_parts
INSERT INTO MAINTENANCE_PARTS (maintenance_id, part_id, quantity)
VALUES (3000, 200, 2);
```